language: node_js
cache:
  npm: false
matrix:
  include:
    - node_js: "node"
      env: CI=coverage
    - node_js: "node"
      env: ESLINT=high
    - node_js: "node"
      env: ESLINT=latest
    - node_js: "8"
    - node_js: "8"
      env: ESLINT=low
    - node_js: "10"


before_install:
  - if [ "$NODE_V" = "4" ]; then npm i -D eslint@4.19.1 espree@3.5.4; fi
  - if [ "$NODE_V" = "4" ]; then npm uninstall -D @mysticatea/eslint-plugin eslint-plugin-es; fi
  - if [ "$ESLINT" = "low" ]; then npm i -D eslint@5.0.0; fi
  - if [ "$ESLINT" = "low" ]; then npm i -S parse5@5.0.0; fi
  - if [ "$ESLINT" = "high" ]; then npm i -D eslint@6.0.0; fi
  - if [ "$ESLINT" = "high" ]; then npm i -S parse5@5.1.0; fi
  - if [ "$ESLINT" = "latest" ]; then npm i -D eslint@latest; fi
  - if [ "$ESLINT" = "latest" ]; then npm i -S parse5@latest; fi
deploy:
  skip_cleanup: true
  provider: npm
  email: $EMAIL
  api_key: $NPM_TOKEN
  on:
    tags: true
notifications:
  email: false
after_success:
  - if [ "$CI" = "coverage" ]; then npm install coveralls --no-save && cat ./coverage/lcov.info | ./node_modules/.bin/coveralls; fi
